Aws_Access_Key_Id = os.getenv('Aws_Access_Key_Id')
Aws_Secret_Access_Key = os.getenv('Aws_Secret_Access_Key')
Region_Name = os.getenv('Region_Name')
session = boto3.Session(
    aws_access_key_id=Aws_Access_Key_Id,
    aws_secret_access_key=Aws_Secret_Access_Key,
    region_name=Region_Name
)
client = session.client("bedrock-runtime", region_name=Region_Name)
model_id = "anthropic.claude-3-haiku-20240307-v1:0"

def llm_response(prompt):
    native_request = {
        "anthropic_version": "bedrock-2023-05-31",
        "max_tokens": 8192,
        "temperature": 0.1,
        "messages": [
            {
                "role": "user",
                "content": [{"type": "text", "text": prompt}],
            }

        ],
    }

    request = json.dumps(native_request)

    try:
        response = client.invoke_model(modelId=model_id, body=request)
        model_response = json.loads(response["body"].read())
        response_text = model_response["content"][0]["text"]
        response_text = str(response_text).replace("```json", "").replace("```", "")
    except (ClientError, Exception) as e:
        print(f"ERROR: Can't invoke '{model_id}'. Reason: {e}")
        response_text=None
    except Exception as e:
        print(str(e))
        response_text = None
    return response_text
